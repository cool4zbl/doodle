---
title: ç§»åŠ¨ç¯å¢ƒä¸‹çš„ SEO
published_at: 20 May 16 @ 02:21
tags: [SEO, shares, tech]
---

çœŸçš„æœ‰å¾ˆä¹…å¾ˆä¹…æ²¡æ¥ç†è¿™ä¸ªåšå®¢ï¼Œè·ç¦»ä¸Šä¸€ç¯‡æ–‡ç« çš„å‘å¸ƒæ—¥æœŸæ˜¯ä¸¤å¹´å‰ã€‚
æ¯•ä¸šå·¥ä½œåæ¥äº†è±†ç“£ï¼Œæœ€è¿‘å¯¹ç§»åŠ¨ç¯å¢ƒï¼ˆä¸»è¦æ˜¯æµè§ˆå™¨åŠå¾®ä¿¡ï¼‰çš„ SEO ç›¸å…³è¿›è¡Œäº†ä¸‹ç ”ç©¶ï¼Œæ­£å¥½åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ã€‚

ä»¥ä¸‹ï¼ŒEnjoyã€‚

<!--truncate-->

---

### 1. SEOï¼šSearch Engine Optimization

äº§å“ï¼šæœç´¢å¼•æ“ä¼˜åŒ–ï¼Œä¿ƒè¿›å†…å®¹ç½‘ç«™ä¿¡æ¯åˆ†äº«ï¼ä¼ æ’­ï¼Œæé«˜ç›®æ ‡è½¬åŒ–ç‡ï¼Œç•™å­˜ç‡

å·¥ç¨‹ï¼šä¸ºå„ç±»é¡µé¢å®ç°ç»Ÿä¸€çš„ä¿¡æ¯åˆ†äº«ã€ä¼ æ’­ï¼Œæé«˜æœç´¢æ’åï¼ˆsearch rankingï¼‰

ä¸ªäººè§‰å¾—ï¼š

- è±†ç“£æ˜¯ä¸€ä¸ªå†…å®¹ç½‘ç«™ï¼Œæ‹¥æœ‰ä¸€äº› UGC ä¼˜è´¨å†…å®¹ï¼ŒSEO é—´æ¥å¸®åŠ©ç”¨æˆ·åˆ†äº«ã€‚
  ä¸”åˆ†äº«ç‡è¶Šé«˜ï¼Œä¹Ÿä¼šæé«˜æœç´¢æ’åã€‚
- M ç«™çš„ç›®å‰é¢å‘** äººï¼ˆUserï¼‰ **çš„ UX æ¯”è¾ƒå®Œå–„ï¼Œä½†æ˜¯ä»éœ€è¦ä¸°å¯Œä¸€äº›ç»†èŠ‚ï¼Œè®© **Search Engine** çš„ UX æ›´å¥½ï¼Œæ›´å¥½åœ°ç†è§£ M ç«™ã€‚



### 2. å‰ç«¯åœ¨ SEO ä¸­çš„ä½ç½®

- **å¸®åŠ©äº§å“è¿›è¡ŒTDK ï¼ˆTitle / Description / Keywordï¼‰ä¼˜åŒ–**
- **æ·»åŠ ä¸€äº› Social Meta Tag ï¼ˆFacebook / Twitter / G+ / WeChat / Weiboï¼‰**
- é¡µé¢å†…å®¹ä¼˜åŒ–ï¼ˆHTML5 æ ‡ç­¾è¯­ä¹‰åŒ–ã€å”¯ä¸€çš„ H1 æ ‡é¢˜ã€img è®¾ç½® `alt` å±æ€§ï¼Œä¸éœ€è¦çˆ¬è™«è·Ÿè¸ªçš„é“¾æ¥åŠ  `nofollow`ï¼‰
- URL ä¼˜åŒ– (**canonical**ï¼Œæ ‡ç­¾è¡¨ç¤ºé¡µé¢çš„å”¯ä¸€æ€§)
  - åœ¨æœç´¢å¼•æ“é‡Œï¼Œ**åªæœ‰é“¾æ¥å®Œå…¨ä¸€æ ·ï¼Œæ‰ä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªé“¾æ¥**ï¼Œå¦‚æœé“¾æ¥å¸¦ä¸Šå‚æ•°ï¼Œè™½ç„¶è®¿é—®åˆ°çš„å†…å®¹è¿˜æ˜¯ä¸€æ ·ï¼Œä½†æ˜¯åœ¨æœç´¢å¼•æ“çœ‹æ¥ç¡®æ˜¯ä¸åŒçš„é“¾æ¥ï¼Œé¡µé¢æŠ“å–ä¹Ÿä¼šå‡ºç°å¤šæ¬¡ï¼Œä»è€Œå¯¼è‡´å¤šä¸ªé“¾æ¥ï¼Œå†…å®¹ä¸€æ ·ã€‚
  - å› æ­¤ URL ä¸­æœ€å¥½æ˜¯ä¸è¦å¸¦ä¸ŠæŸ¥è¯¢å‚æ•°ã€‚ä½†ä¸ºäº†äº§å“ç»Ÿè®¡æ•°æ®ï¼Œæ€»éœ€è¦ `?from=xxx&refer=xxx`ç­‰å‚æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨ `canonical`æ ‡ç­¾æ¥ç¡®ä¿é“¾æ¥å”¯ä¸€æ€§ï¼Œé¿å…æƒé‡åˆ†æ•£ã€æµå¤±ã€‚
  - æ¯”å¦‚ ` m.douban.com/group/topics[?start=xxx]`å‡è§†ä¸ºåŒä¸€ä¸ªé¡µé¢è¿™é‡Œçš„ `?start=xxx`æ˜¯ä¸€ä¸ªåˆ†é¡µæŸ¥è¯¢å‚æ•°ï¼Œæ‰€ä»¥ä¸ºäº†ç¡®ä¿è¿™äº›é¡µé¢éƒ½èƒ½ç»§æ‰¿ m.douban.group/toics è¿™ä¸ª url  çš„æƒé‡ï¼Œåœ¨`head`ä¸­å¢åŠ äº†`canonical`æ ‡ç­¾
- Meta robots
- Sitemap



### 3. å…·ä½“å®ç°

> **ç»Ÿä¸€ SNS æŠ“å–**
>
> æä¾›ä¸€ä¸ª mako å‡½æ•°ï¼Œç»Ÿä¸€åˆ†äº«çš„æ ‡é¢˜ã€å›¾ç‰‡ã€æè¿°
>
> - Open Graph
> - Twitter Card
>
> **å®ç°ç»Ÿä¸€çš„åˆ†äº«æ¥å£**
>
> å¯å˜çš„å›¾ç‰‡ã€æ ‡é¢˜ã€æè¿°
>
> - å¾®ä¿¡ ï¼ˆiOSã€Android ç³»ç»Ÿåˆ†äº«èœå•ã€å¾®ä¿¡å†…ç½®åˆ†äº«ï¼‰
>
> - - å¤–éƒ¨è°ƒç”¨åˆ†äº«å¯èƒ½ä¼šæŠ“å–æ ‡é¢˜ã€ç¬¬ä¸€ä¸ªå›¾ç‰‡åœ°å€ï¼ˆOpen Graphï¼‰
>   - è°ƒç”¨å†…ç½®åˆ†äº«å¯ç”¨ç¬¬ä¸‰ä¸ªé“¾æ¥ (API è·¨å­åŸŸ)
>
> - å¾®åš
>
> å‚è€ƒé“¾æ¥ï¼š
>
> [https://developers.facebook.com/docs/sharing/opengraph](https://developers.facebook.com/docs/sharing/opengraph)
>
> [https://dev.twitter.com/cards/overview](https://dev.twitter.com/cards/overview)
>
> [http://github.intra.douban.com/frodo/Talion/blob/master/views/j/wechat/__init__.py](http://github.intra.douban.com/frodo/Talion/blob/master/views/j/wechat/__init__.py)Â 
>
> â€” From [Douban FE Dropbox](https://paper.dropbox.com/doc/-SEO-UVIgU3WYPUeiJv3nOPP0N)



### å®ç°æ–¹æ¡ˆ

#### 1. å¢åŠ äº† `seo_meta()` Mako widget

 http://github.intra.douban.com/frodo/Talion/blob/master/templates/card/widgets.html#L527

```html
<%def name="seo_meta(title, desc, image=None, url=None, type=None, rating_count=None, rating_val=None, wechat_timeline_title=None,wechat_chat_title=None, wechat_desc=None, wechat_image=None)">
    <%
        from douban.image.qiniu import qiniu_proxy_url

        default_title = 'è±†ç“£'
        default_desc = 'è¯»ä¹¦ã€çœ‹ç”µå½±ã€æ¶¨çŸ¥è¯†ã€å­¦ç©¿æ­...ï¼ŒåŠ å…¥å…´è¶£å°ç»„ï¼Œè·å¾—è¾¾äººä»¬çš„é«˜è´¨é‡ç”Ÿæ´»ç»éªŒï¼Œæ‰¾åˆ°æœ‰ç›¸åŒçˆ±å¥½çš„å°ä¼™ä¼´ã€‚'
        default_image = static('/pics/icon/m_logo_180.png')
        default_url = 'http://m.douban.com/'
        default_type = 'article'
        image = qiniu_proxy_url(image, 300, 300, mode='1') if image else ''
    %>
    <!-- Schema.org markup for Google+ -->
    <meta itemprop="name" content="${ title or default_title }">
    <meta itemprop="description" content="${ desc or default_desc }">
    <meta itemprop="image" content="${ image or default_image }">
    % if rating_count:
    <meta itemprop="reviewCount" content="${ rating_count }">
    % endif
    % if rating_val:
    <meta itemprop="ratingValue" content="${ rating_val }">
    % endif
    <!-- Twitter meta -->
    <meta name="twitter:card" content="summary" />
    <!-- Open Graph meta -->
    <meta property="og:title" content="${ title or default_title }" />
    <meta property="og:description" content="${ desc or default_desc }" />
    <meta property="og:site_name" content="è±†ç“£(æ‰‹æœºç‰ˆ)" />
    <meta property="og:url" content="${ url or default_url }" />
    <meta property="og:image" content="${ image or default_image }" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="300" />
    <meta property="og:image:height" content="300" />
    <meta property="og:type" content="${ type or default_type }" />
    <!-- Wechat meta -->
    <meta property="weixin:timeline_title" content="${ wechat_timeline_title or '' }" />
    <meta property="weixin:chat_title" content="${ wechat_chat_title or '' }" />
    <meta property="weixin:description" content="${ wechat_desc or '' }" />
    <meta property="weixin:image" content="${ image or default_image }" />
    <%block filter="collect_js">
    ;(function () {
        window.setMeta = function (name, val) {
          var meta = document.querySelectorAll('meta[property="' + name + '"], meta[name="' + name + '"]')
          if (!meta.length) {
            meta = document.createElement('meta')
            meta.name = name
            document.head.appendChild(meta)
          }
         meta[0].content = val || ''
        }
        window.getMeta = function (name) {
          var meta = document.querySelectorAll('meta[property="' + name + '"], meta[name="' + name + '"]')
          if (!meta.length) {
            return ''
          } else {
            return meta[0].content
          }
        }
        setMeta('og:url', location.href)
        !getMeta('weixin:chat_title') && setMeta('weixin:chat_title', document.title)
        !getMeta('weixin:timeline_title') && setMeta('weixin:timeline_title', document.title)
        !getMeta('weixin:description') && setMeta('weixin:description', getMeta('og:description'))
    })();
    </%block>
</%def>
```


#### 2. ç»™ m ç«™å¤§éƒ¨åˆ†é¡µé¢å¢åŠ äº† SEO Meta Tags

ä¹‹å‰åˆ†äº«å‡ºå»æŠ“ä¸åˆ°è‡ªå®šä¹‰çš„ description å’Œ image ï¼Œç°é»˜è®¤åˆ†äº«åˆ° weixin çš„ title ã€ description ã€image å€¼éƒ½å’Œ Open Graph ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚

é»˜è®¤æƒ…å†µä¸‹

- `og:title`ï¼Œ` og:description` å’Œä¹‹å‰çš„ title, description ä¸€æ ·ï¼›


- `og:url`ï¼š å½“å‰é¡µé¢ urlï¼›
- `og:image`ï¼š
  -  å°ç»„å¸–å­é¡µå’Œå•ä¸ªæ—¥è®°é¡µå¦‚æœ‰å›¾ç‰‡ï¼Œåˆ™ä¸ºç¬¬ä¸€å¼ å›¾ç‰‡çš„ src urlï¼Œæ²¡æœ‰çš„è¯ä¸ºç°åœ¨é»˜è®¤çš„åˆ†äº« icon src urlï¼›
  -  æ¡ç›®é¡µçš„å‡ä¸ºè¯¥æ¡ç›®çš„ image src urlï¼›
  -  ç›¸å†Œé¡µä¸ºè¯¥ç›¸å†Œç¬¬ä¸€å¼  image srcï¼›
  -  è±†åˆ—ã€æ ‡ç­¾é¡µä¸ºé»˜è®¤çš„åˆ†äº« icon src


- **Hashtag é¡µ**

  - image: è¿è¥å¤´å›¾ || è±† iconï¼›
  - title: `{ hashtag_name} - è±†ç“£`ï¼›
  - description: è¿è¥æè¿° || 'æœ‰å…³`#{ hashtag_name }`#çš„è¯é¢˜è®¨è®ºï¼Œè±†ç“£ç”¨æˆ·å‚ä¸çš„ç²¾å½©è¯é¢˜'ï¼›

- **å•æ¡å¹¿æ’­é¡µ**

  - å¾®ä¿¡èŠå¤©ã€æœ‹å‹åœˆï¼šimage =  å¹¿æ’­ç¬¬ä¸€å¼ å›¾ || è±† iconï¼›
  - å¾®ä¿¡èŠå¤©é¡µï¼š title = XXX çš„è±†ç“£å¹¿æ’­; description = å¹¿æ’­æ–‡å­—å†…å®¹çš„å‰åäº”ä¸ªå­— || é»˜è®¤çš„ m ç«™æè¿°ï¼›
  - å¾®ä¿¡æœ‹å‹åœˆï¼š title = å¹¿æ’­æ–‡å­—å†…å®¹å‰åäº”ä¸ªå­— || XXX çš„è±†ç“£å¹¿æ’­

- å…³äº image å›¾ç‰‡è§„æ ¼ï¼š

  ä¸ºäº†ä½¿æŠ“å–çš„å›¾ç‰‡æ›´ä¼˜é›…ï¼Œä¸è¢«å‹ç¼©å˜å½¢ï¼Œä½¿ç”¨ã€Œä¸ƒç‰›å›¾ç‰‡æœåŠ¡ã€è¿›è¡Œå‰ªè£ã€‚

  é»˜è®¤ `og:image` ç­‰ image å‡ä¼šè¢«ä»¥ `width = height = 300` è¿›è¡Œå¤„ç†ã€‚

  - [Talion](http://github.intra.douban.com/frodo/Talion/tree/23fe149cc3186f15195634cca774861d3ce9efca)/[libs](http://github.intra.douban.com/frodo/Talion/tree/23fe149cc3186f15195634cca774861d3ce9efca/libs)/**image.py**
  - http://github.intra.douban.com/frodo/Talion/blob/23fe149cc3186f15195634cca774861d3ce9efca/libs/image.py#L11
  - `from douban.image.qiniu import qiniu_proxy_url`


æ•ˆæœæˆªå±ï¼š

http://github.intra.douban.com/frodo/Talion/pull/253



#### 3. ç»Ÿä¸€åˆ†äº«æ¥å£ï¼ˆå¾®ä¿¡é‡åº¦ä½¿ç”¨æ‚£è€…ï¼‰

- [weixin.js](http://github.intra.douban.com/frodo/Talion/blob/master/static/js/card/weixin.js#L52)ã€ [å¾®ä¿¡ JSSDK æ–‡æ¡£](https://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html#.E5.88.86.E4.BA.AB.E6.8E.A5.E5.8F.A3)

```javascript

wx.onMenuShareTimeline($.extend({}, shareData,{
    title: window.getMeta('weixin:timeline_title') || document.title,
    success: function () {
        wxShareStat.target = 'timeline';
        $.get('/j/wechat/shared', wxShareStat);
    },
    cancel: function () {}
}));

wx.onMenuShareAppMessage($.extend({}, shareData,{
    title: window.getMeta('weixin:chat_title') || document.title,
    desc: window.getMeta('weixin:description') || window.getMeta('og:description'),
    success: function () {
        wxShareStat.target = 'friend';
        $.get('/j/wechat/shared', wxShareStat);
    },
    cancel: function () {}
}));
```

  ç»“åˆä½¿ç”¨ `meta[name="weixin:image"]`

```html
<meta property="weixin:timeline_title" content="${ wechat_timeline_title or '' }" />
<meta property="weixin:chat_title" content="${ wechat_chat_title or '' }" />
<meta property="weixin:description" content="${ wechat_desc or '' }" />
<meta property="weixin:image" content="${ image or default_image }" />
```

-  è‡ªå®šä¹‰å¾®ä¿¡åˆ†äº«åˆ°èŠå¤©ã€æœ‹å‹åœˆçš„æ˜¾ç¤ºå†…å®¹ï¼Œæ–‡æ¡ˆ`setMeta()`, `getMeta()`

-  **Tips:** å¦‚æœæ²¡æœ‰è®¾ç½® `wx.onMenuShareTimeline()`/ `wx.onMenuShareAppMessage()` ä¸­çš„ title / imgUrl / desc å‚æ•°ï¼Œå¾®ä¿¡å†…ç½®æµè§ˆå™¨é»˜è®¤æŠ“å–å¯¹åº”çš„`og:xxx` ç›¸å…³ã€‚

-  **Bugs:** é€šè¿‡ Safari Extension åˆ†äº«å‡ºæ¥çš„æ°¸è¿œæŠ“çš„æ˜¯ `apple-touch-icon` ğŸ˜‚

```html
<link rel="apple-touch-icon-precomposed" href="https://img3.doubanio.com/f/talion/315ba4fc82e5cdb5c50ef1d9f88c8aa2c5c0c4ba/pics/icon/m_logo_76.png">
```

å¾®ä¿¡åˆ†äº«æ•ˆæœå›¾ï¼š
![after_seo_1](./seo_1.png)
![after_seo_2](./seo_2.png)
![after_seo_3](./seo_3.png)



### Further Reading & Resource

1. Sitemap & [Deadlink](http://baiduseoguide.com/news/20141128113.html)
2. Social Meta Tag Cheatsheet
3. Google SEO TOP1: Baidu Baike ğŸ˜‚
4. [Apple Safari supported meta tags](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)
5. [Google SEO search-engine-optimization-starter-guide](http://static.googleusercontent.com/media/www.google.com/en//webmasters/docs/search-engine-optimization-starter-guide.pdf)
6. Google ç»“æ„åŒ–æ•°æ®æ ‡è®°è¾…åŠ©å·¥å…·
7. [SEO Tutorial](http://www.hobo-web.co.uk/seo-tutorial/)
8. [äº¬ä¸œ SEO](http://www.ghugo.com/jd-seo/)
9. SEO Tools
   - [Google Webmasters Search Console](https://www.google.com/webmasters/)
   - [Varvy SEO tool](https://varvy.com/tools/)
   - [Keyword Tool](http://keywordtool.io/)

